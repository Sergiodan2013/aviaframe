[build]
  base = "portal/client"
  # After vite build, write-redirects.js generates dist/_redirects using BACKEND_URL env var.
  # Set BACKEND_URL in Netlify → Site configuration → Environment variables.
  # Example: BACKEND_URL=https://your-ngrok-subdomain.ngrok-free.dev
  command = "npm ci && npm run build && node scripts/write-redirects.js"
  publish = "dist"

# SPA fallback — all /api/* rules are in dist/_redirects (generated at build time).
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
